# P05 — Cloud-safe i18n (default ru) + per-user locale + fallback

## Implementation notes
- Stores a per-user locale preference (ru/en) and defaults new users to Russian.
- Adds a user-facing locale setting on the Settings page and persists changes via an API endpoint.
- Moves authenticated pages to resolve locale from the user profile rather than browser headers.
- Ensures missing translation keys fall back to Russian via deep merge.

## UX coverage
- Shell navigation, dashboard header, and contacts empty-state actions are driven by translation keys.
- Settings page includes a locale preference card with save feedback.

## Key files
- `lib/text.ts` — translation keys, deep fallback, and locale resolution.
- `lib/locale.ts` — user locale lookup for server components.
- `components/settings/locale-preference.tsx` — profile locale selector.
- `app/api/users/locale/route.ts` — read/update locale preference.
- `db/migrations/002_add_user_locale.sql` — user locale persistence.

## Local verification
See `LOCAL_VERIFICATION.md` for the full checklist and P05 commands.
