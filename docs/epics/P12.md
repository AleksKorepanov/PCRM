# P12 â€” Cloud-safe Communities + memberships (rules, requirements, links)

## Implementation notes
- Added an in-memory communities store with rules, entry requirements, links, and workspace-scoped memberships.
- Memberships track roles and joined/left dates, keeping contact community tags in sync.
- Community edits emit audit log entries for CRUD and membership changes.

## UX coverage
- Communities dashboard surfaces filters for community, member role, and Needs/Offers status/type.
- Community detail panel highlights rules, entry requirements, and links alongside member roster.
- Needs/Offers list rolls up entries from community members.

## API surface
- `GET/POST /api/communities` for community listing/creation.
- `GET/PATCH/DELETE /api/communities/:communityId` for updates and removal.
- `GET/POST /api/communities/:communityId/memberships` for member mapping.
- `PATCH/DELETE /api/communities/:communityId/memberships/:membershipId` for membership edits.

## Privacy and RBAC
- Workspace scoping enforced in community and membership queries.
- Community edits and membership changes require assistant-level access.
- Audit logs captured for community and membership mutations.

## Key files
- `lib/communities.ts`
- `app/(app)/communities/page.tsx`
- `components/communities/communities-dashboard.tsx`
- `app/api/communities/*`
- `db/migrations/003_add_community_metadata.sql`
- `__tests__/communities.test.ts`

## Local verification
See `LOCAL_VERIFICATION.md` for the full checklist and P12 commands.
